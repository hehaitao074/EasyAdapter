<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Easyadapter by mzule</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Easyadapter</h1>
        <p class="header">Easy to use adapters.</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/mzule/EasyAdapter/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/mzule/EasyAdapter/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/mzule/EasyAdapter">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/mzule">mzule</a></p>


      </header>
      <section>
        <h1>
<a id="easyadapter" class="anchor" href="#easyadapter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EasyAdapter</h1>

<p>一种简单的Adapter解决方案，支持多种ViewType，轻松创建<code>ViewHolder</code>模式Adapter. 支持<code>ListView</code>和<code>RecyclerView</code>.</p>

<h2>
<a id="安装" class="anchor" href="#%E5%AE%89%E8%A3%85" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>安装</h2>

<p>仅支持<code>ListView</code></p>

<div class="highlight highlight-source-groovy"><pre>dependencies {
    compile <span class="pl-s"><span class="pl-pds">'</span>com.github.mzule.easyadapter:easyadapter:1.1.2<span class="pl-pds">'</span></span>
}</pre></div>

<p>需要支持<code>RecyclerView</code></p>

<div class="highlight highlight-source-groovy"><pre>dependencies {
    compile <span class="pl-s"><span class="pl-pds">'</span>com.github.mzule.easyadapter:easyadapter:1.1.2<span class="pl-pds">'</span></span>
    compile <span class="pl-s"><span class="pl-pds">'</span>com.github.mzule.easyadapter:easyadapterrecycler:1.1.2<span class="pl-pds">'</span></span>
}</pre></div>

<h2>
<a id="使用步骤" class="anchor" href="#%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>使用步骤</h2>

<p>项目包含四个类, <code>ViewType</code>, <code>SingleTypeAdapter</code>, <code>MultiTypeAdapter</code>, <code>TypePerEntityAdapter</code>, 其中<code>ViewType</code>负责创建、绑定(Hold)、渲染View；<code>SingleTypeAdapter</code>支持单独一种样式类型的Adapter, <code>MultiTypeAdapter</code>, <code>TypePerEntityAdapter</code>支持多种样式类型的Adapter；<code>TypePerEntityAdapter</code>是<code>MultiTypeAdapter</code>的子类。</p>

<h3>
<a id="1-编写viewtypes" class="anchor" href="#1-%E7%BC%96%E5%86%99viewtypes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 编写<code>ViewType</code>(s)</h3>

<p><code>ViewType</code>负责创建、绑定、渲染View，每个<code>ViewType</code>对应传统模式下的一个<code>ViewHolder</code>，一个典型的<code>ViewType</code>实现如下：</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">TipViewType</span> <span class="pl-k">extends</span> <span class="pl-e">ViewType&lt;<span class="pl-smi">String</span>&gt;</span> {
    <span class="pl-k">private</span> <span class="pl-smi">TextView</span> tipView;

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onCreate</span>() {
        setContentView(<span class="pl-smi">R</span><span class="pl-k">.</span>layout<span class="pl-k">.</span>item_tip);
        <span class="pl-v">this</span><span class="pl-k">.</span>tipView <span class="pl-k">=</span> findViewById(<span class="pl-smi">R</span><span class="pl-k">.</span>id<span class="pl-k">.</span>tip);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onRender</span>(<span class="pl-k">int</span> <span class="pl-v">position</span>, <span class="pl-smi">String</span> <span class="pl-v">tip</span>) {
        tipView<span class="pl-k">.</span>setText(tip);
    }
}</pre></div>

<p><code>ViewType</code>提供了一个<code>findViewById(int)</code>方法，可以根据声明的类型进行强制转换。</p>

<ol>
<li>
<code>onCreate</code>可以通过调用<code>setContentView(int)</code>或者<code>setContentView(View)</code>创建View，初始化成员变量;</li>
<li>
<code>onRender(int, T)</code>负责渲染UI，绑定数据.</li>
</ol>

<p><code>ViewType</code>还提供了一个<code>getAdapter()</code>方法直接直接操作Adapter.以及一个<code>isEditMode()</code>检查当前是否在编辑模式.</p>

<h3>
<a id="2-选择合适的adapter" class="anchor" href="#2-%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84adapter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 选择合适的<code>Adapter</code>
</h3>

<p>项目为<code>ListView</code>,<code>RecyclerVIew</code>个提供了3个<code>Adapter</code>基类，名字一样，只是包名略作区分，分别是<code>com.github.mzule.easyadapter</code>,<code>com.github.mzule.easyadapter.recycler</code>。下面一一说明。</p>

<h4>
<a id="1-singletypeadapter" class="anchor" href="#1-singletypeadapter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. SingleTypeAdapter</h4>

<p><code>SingleTypeAdapter</code>适合仅有一种类型View的<code>ListView</code>，典型实现如下：</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">PlainAdapter</span> <span class="pl-k">extends</span> <span class="pl-e">SingleTypeAdapter&lt;<span class="pl-smi">String</span>&gt;</span> {

    <span class="pl-k">public</span> <span class="pl-en">PlainAdapter</span>(<span class="pl-smi">Context</span> <span class="pl-v">context</span>) {
        <span class="pl-v">super</span>(context);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">protected</span> <span class="pl-k">Class&lt;? extends <span class="pl-smi">ViewType</span>&gt;</span> <span class="pl-en">singleViewType</span>() {
        <span class="pl-k">return</span> <span class="pl-smi">TipViewType</span><span class="pl-k">.</span>class;
    }
}</pre></div>

<h4>
<a id="2-multitypeadapter" class="anchor" href="#2-multitypeadapter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. MultiTypeAdapter</h4>

<p>顾名思义，<code>MultiTypeAdapter</code>适用于需要在<code>ListView</code>上显示多种类型View的时候，比如说微博客户端，一堆微博之间，夹杂几个广告，正好适用。典型实现：</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">ArticleAdapter</span> <span class="pl-k">extends</span> <span class="pl-e">MultiTypeAdapter&lt;<span class="pl-smi">Article</span>&gt;</span> {

    <span class="pl-k">public</span> <span class="pl-en">ArticleAdapter</span>(<span class="pl-smi">Context</span> <span class="pl-v">context</span>) {
        <span class="pl-v">super</span>(context);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">protected</span> <span class="pl-k">void</span> <span class="pl-en">registerViewTypes</span>() {
        registerViewType(<span class="pl-smi">ArticleBriefViewType</span><span class="pl-k">.</span>class);
        registerViewType(<span class="pl-smi">ArticleFullViewType</span><span class="pl-k">.</span>class);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">protected</span> <span class="pl-k">Class&lt;? extends <span class="pl-smi">ViewType</span>&gt;</span> <span class="pl-en">getViewType</span>(<span class="pl-k">int</span> <span class="pl-v">position</span>, <span class="pl-smi">Article</span> <span class="pl-v">data</span>) {
        <span class="pl-k">switch</span> (data<span class="pl-k">.</span>getStyle()) {
            <span class="pl-k">case</span> <span class="pl-smi">Article</span><span class="pl-c1"><span class="pl-k">.</span>STYLE_FULL</span><span class="pl-k">:</span>
                <span class="pl-k">return</span> <span class="pl-smi">ArticleFullViewType</span><span class="pl-k">.</span>class;
            <span class="pl-k">case</span> <span class="pl-smi">Article</span><span class="pl-c1"><span class="pl-k">.</span>STYLE_BRIEF</span><span class="pl-k">:</span>
                <span class="pl-k">return</span> <span class="pl-smi">ArticleBriefViewType</span><span class="pl-k">.</span>class;
        }
        <span class="pl-k">return</span> <span class="pl-c1">null</span>;
    }
}</pre></div>

<h4>
<a id="3typeperentityadapter" class="anchor" href="#3typeperentityadapter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.TypePerEntityAdapter</h4>

<p><code>TypePerEntityAdapter</code>是<code>MultiTypeAdapter</code>的子类，适用于每个数据实体class都对应不同的<code>ViewType</code>实现，例如:</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">TimelineAdapter</span> <span class="pl-k">extends</span> <span class="pl-e">TypePerEntityAdapter&lt;<span class="pl-smi">Object</span>&gt;</span> {

    <span class="pl-k">public</span> <span class="pl-en">TimelineAdapter</span>(<span class="pl-smi">Context</span> <span class="pl-v">context</span>) {
        <span class="pl-v">super</span>(context);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">protected</span> <span class="pl-k">void</span> <span class="pl-en">mapEntityViewTypes</span>() {
        mapEntityViewType(<span class="pl-smi">Post</span><span class="pl-k">.</span>class, <span class="pl-smi">PostViewType</span><span class="pl-k">.</span>class);
        mapEntityViewType(<span class="pl-smi">Repost</span><span class="pl-k">.</span>class, <span class="pl-smi">RepostViewType</span><span class="pl-k">.</span>class);
        mapEntityViewType(<span class="pl-smi">String</span><span class="pl-k">.</span>class, <span class="pl-smi">TipViewType</span><span class="pl-k">.</span>class);
        mapEntityViewType(<span class="pl-smi">Recommend</span><span class="pl-k">.</span>class, <span class="pl-smi">RecommendViewType</span><span class="pl-k">.</span>class);
        mapEntityViewType(<span class="pl-smi">Ad</span><span class="pl-k">.</span>class, <span class="pl-smi">AdViewType</span><span class="pl-k">.</span>class);
    }
}</pre></div>

<h3>
<a id="3-应用adapter" class="anchor" href="#3-%E5%BA%94%E7%94%A8adapter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 应用<code>Adapter</code>
</h3>

<p>通过<code>ListView#setAdapter(Adapter)</code>使用Adapter,通过<code>add(List)</code>/<code>addAndNotify(List)</code>/<code>clear()</code>/<code>clearAndNotify()</code>添加或修改Adapter内的数据。<code>add(List)</code>和<code>addAndNotify(List)</code>的区别在于是否自动调用<code>notifyDataSetChanged()</code>, <code>clear</code>亦然。</p>

<div class="highlight highlight-source-java"><pre><span class="pl-smi">ListView</span> listView <span class="pl-k">=</span> (<span class="pl-smi">ListView</span>) findViewById(<span class="pl-smi">R</span><span class="pl-k">.</span>id<span class="pl-k">.</span>listView);
listView<span class="pl-k">.</span>setAdapter(adapter);
<span class="pl-k">List&lt;<span class="pl-smi">String</span>&gt;</span> fake <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">ArrayList&lt;&gt;</span>();
<span class="pl-k">for</span> (<span class="pl-k">int</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> <span class="pl-c1">100</span>; i<span class="pl-k">++</span>) {
    fake<span class="pl-k">.</span>add(<span class="pl-c1">UUID</span><span class="pl-k">.</span>randomUUID()<span class="pl-k">.</span>toString());
}
adapter<span class="pl-k">.</span>addAndNotify(fake);</pre></div>

<h2>
<a id="尽情享用" class="anchor" href="#%E5%B0%BD%E6%83%85%E4%BA%AB%E7%94%A8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>尽情享用</h2>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
